"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[418],{6418:function(e,a,t){t.r(a),t.d(a,{default:function(){return d}});var o=function(){var e=this,a=e._self._c;return a("div",[a("div",{staticStyle:{display:"flex"}},[a("div",{staticStyle:{flex:"6"}},[a("el-input",{staticStyle:{"margin-top":"-5px",width:"81%"},attrs:{id:e.inputObject.inputId,placeholder:"请输入你要查找的关键词"},model:{value:e.inputObject.userInput,callback:function(a){e.$set(e.inputObject,"userInput",a)},expression:"inputObject.userInput"}}),a("el-button",{staticStyle:{"margin-top":"-5px",float:"right",width:"120px"},attrs:{type:"primary"},on:{click:e.send}},[e._v("查询")])],1),a("div",{staticStyle:{flex:"4","margin-left":"20px","margin-top":"-10px"}},[a("div",[a("span",[e._v("点击地址：")]),a("span",[e._v(e._s(e.placeAddress))])]),a("div",[a("span",[e._v("点击坐标：")]),a("span",[e._v(e._s(e.placeLocation))])])]),a("div",{staticStyle:{flex:"1"}},["ROLE_ADMIN"===e.user.role?a("el-button",{staticStyle:{"margin-top":"-5px",float:"right",width:"120px"},attrs:{type:"success"},on:{click:e.update}},[e._v("确认地址")]):e._e()],1)]),a("div",{staticStyle:{width:"100%",height:"calc(95vh - 100px)","margin-top":"10px"},attrs:{id:"container"}}),a("el-dialog",{attrs:{title:"确认地址信息",visible:e.dialogFrom,width:"30%"},on:{"update:visible":function(a){e.dialogFrom=a}}},[a("el-form",{attrs:{"label-width":"70px",size:"small"}},[a("el-form-item",{attrs:{label:"地址："}},[a("span",{model:{value:e.form.address,callback:function(a){e.$set(e.form,"address",a)},expression:"form.address"}},[e._v(e._s(e.placeAddress))])]),a("el-form-item",{attrs:{label:"经度："}},[a("span",{model:{value:e.form.addressLng,callback:function(a){e.$set(e.form,"addressLng",a)},expression:"form.addressLng"}},[e._v(e._s(e.placeLng))])]),a("el-form-item",{attrs:{label:"纬度："}},[a("span",{model:{value:e.form.addressLat,callback:function(a){e.$set(e.form,"addressLat",a)},expression:"form.addressLat"}},[e._v(e._s(e.placeLat))])])],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(a){e.dialogFrom=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("确 定")])],1)],1)],1)},n=[],i=(t(7658),t(7634)),s=t.n(i);window._AMapSecurityConfig={securityJsCode:"bb1f932883d837cc53c75d65d70dcc16"};var l={name:"Map",data(){return{user:localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")):{},map:null,marker:null,oldMarker:null,autoOptions:{input:""},searchPlaceInput:"",auto:null,inputObject:{userInput:"",inputId:"searchInput"},placeSearch:null,college:[],arr:[],placeAddress:"",placeLocation:"",placeLng:"",placeLat:"",collegeAddress:"",flag:0,dialogFrom:!1,form:{}}},created(){this.autoOptions.input=this.inputObject.inputId,this.getMap()},watch:{searchPlaceInput(e){null!=e&&this.placeSearch.search(e)}},methods:{async initMap(){var e=this;s().load({key:"dbeb4ce6db4f24beaec8217d5ffdb847",version:"2.0",plugins:["AMap.ToolBar","AMap.Scale","AMap.HawkEye","AMap.MapType","AMap.Geolocation","AMap.AutoComplete","AMap.PlaceSearch","AMap.Geocoder"]}).then((a=>{this.map=new a.Map("container",{viewMode:"3D",zoom:5}),this.map.addControl(new a.Scale),this.map.addControl(new a.ToolBar),this.map.addControl(new a.HawkEye),this.map.addControl(new a.MapType),this.map.addControl(new a.Geolocation),this.auto=new a.AutoComplete(this.autoOptions),this.placeSearch=new a.PlaceSearch({map:this.map}),this.auto.on("select",this.select),this.map.on("click",(e=>{let a=e.lnglat.lat,t=e.lnglat.lng;this.getLngLatService(t,a)}));var t=new a.InfoWindow({offset:new a.Pixel(0,-30)});for(let e=0;e<this.college.length;e++){let t=new a.Marker({position:new a.LngLat(this.college[e].addressLng,this.college[e].addressLat),map:this.map,offset:new a.Pixel(-15,-20)});this.map.add([t]),t.content="机构"+this.college[e].name+"店",t.content="机构"+this.college[e].name+"店",t.on("click",o)}function o(a){t.setContent(a.target.content),t.open(e.map,a.target.getPosition())}})).catch((e=>{console.log(e)}))},send(){this.searchPlaceInput=this.inputObject.userInput},select(e){this.placeSearch.setCity(e.poi.adcode),this.placeSearch.search(e.poi.name)},getMap(){this.request.get("/college").then((e=>{this.college=e.data;for(let a=0;a<this.college.length;a++)this.arr.push(this.college[a].address);console.log("========"+this.arr),console.log("***************"+this.college[0].addressLat),this.initMap()}))},getLngLatService(e,a){let t=[e,a],o=new AMap.LngLat(e,a),n=new AMap.Geocoder({city:"全国"}),i=new AMap.Marker({position:new AMap.LngLat(e,a)});this.map.add(i);let s="";n.getAddress(o,((o,n)=>{if("complete"===o&&n.regeocode){s=n.regeocode.formattedAddress;var l={addressLng:e,addressLat:a,address:s};this.collegeAddress=l,console.log(this.collegeAddress),this.placeAddress=s,this.placeLocation=t,this.placeLng=e,this.placeLat=a,this.flag>0&&(console.log("++++++++++++"+this.flag),this.map.remove(this.oldMarker)),this.oldMarker=i,this.flag+=1}else log.error("根据经纬度查询地址失败")}))},update(){this.form={},this.dialogFrom=!0},save(){this.request.post("/college",this.collegeAddress).then((e=>{"200"===e.code?(this.$message.success("保存成功"),this.dialogFrom=!1):this.$message.error("保存失败")}))}},mounted(){this.send()}},r=l,p=t(1001),c=(0,p.Z)(r,o,n,!1,null,null,null),d=c.exports},7634:function(e,a,t){t(7658),t(1703),function(a,t){e.exports=t()}(0,(function(){function e(e){var o=[];return e.AMapUI&&o.push(a(e.AMapUI)),e.Loca&&o.push(t(e.Loca)),Promise.all(o)}function a(e){return new Promise((function(a,t){var l=[];if(e.plugins)for(var r=0;r<e.plugins.length;r+=1)-1==n.AMapUI.plugins.indexOf(e.plugins[r])&&l.push(e.plugins[r]);if(i.AMapUI===o.failed)t("前次请求 AMapUI 失败");else if(i.AMapUI===o.notload){i.AMapUI=o.loading,n.AMapUI.version=e.version||n.AMapUI.version,r=n.AMapUI.version;var p=document.body||document.head,c=document.createElement("script");c.type="text/javascript",c.src="https://webapi.amap.com/ui/"+r+"/main.js",c.onerror=function(e){i.AMapUI=o.failed,t("请求 AMapUI 失败")},c.onload=function(){if(i.AMapUI=o.loaded,l.length)window.AMapUI.loadUI(l,(function(){for(var e=0,t=l.length;e<t;e++){var o=l[e].split("/").slice(-1)[0];window.AMapUI[o]=arguments[e]}for(a();s.AMapUI.length;)s.AMapUI.splice(0,1)[0]()}));else for(a();s.AMapUI.length;)s.AMapUI.splice(0,1)[0]()},p.appendChild(c)}else i.AMapUI===o.loaded?e.version&&e.version!==n.AMapUI.version?t("不允许多个版本 AMapUI 混用"):l.length?window.AMapUI.loadUI(l,(function(){for(var e=0,t=l.length;e<t;e++){var o=l[e].split("/").slice(-1)[0];window.AMapUI[o]=arguments[e]}a()})):a():e.version&&e.version!==n.AMapUI.version?t("不允许多个版本 AMapUI 混用"):s.AMapUI.push((function(e){e?t(e):l.length?window.AMapUI.loadUI(l,(function(){for(var e=0,t=l.length;e<t;e++){var o=l[e].split("/").slice(-1)[0];window.AMapUI[o]=arguments[e]}a()})):a()}))}))}function t(e){return new Promise((function(a,t){if(i.Loca===o.failed)t("前次请求 Loca 失败");else if(i.Loca===o.notload){i.Loca=o.loading,n.Loca.version=e.version||n.Loca.version;var l=n.Loca.version,r=n.AMap.version.startsWith("2"),p=l.startsWith("2");if(r&&!p||!r&&p)t("JSAPI 与 Loca 版本不对应！！");else{r=n.key,p=document.body||document.head;var c=document.createElement("script");c.type="text/javascript",c.src="https://webapi.amap.com/loca?v="+l+"&key="+r,c.onerror=function(e){i.Loca=o.failed,t("请求 AMapUI 失败")},c.onload=function(){for(i.Loca=o.loaded,a();s.Loca.length;)s.Loca.splice(0,1)[0]()},p.appendChild(c)}}else i.Loca===o.loaded?e.version&&e.version!==n.Loca.version?t("不允许多个版本 Loca 混用"):a():e.version&&e.version!==n.Loca.version?t("不允许多个版本 Loca 混用"):s.Loca.push((function(e){e?t(e):t()}))}))}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var o;(function(e){e.notload="notload",e.loading="loading",e.loaded="loaded",e.failed="failed"})(o||(o={}));var n={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},i={AMap:o.notload,AMapUI:o.notload,Loca:o.notload},s={AMap:[],AMapUI:[],Loca:[]},l=[],r=function(e){"function"==typeof e&&(i.AMap===o.loaded?e(window.AMap):l.push(e))};return{load:function(a){return new Promise((function(t,s){if(i.AMap==o.failed)s("");else if(i.AMap==o.notload){var p=a.key,c=a.version,d=a.plugins;p?(window.AMap&&"lbs.amap.com"!==location.host&&s("禁止多种API加载方式混用"),n.key=p,n.AMap.version=c||n.AMap.version,n.AMap.plugins=d||n.AMap.plugins,i.AMap=o.loading,c=document.body||document.head,window.___onAPILoaded=function(n){if(delete window.___onAPILoaded,n)i.AMap=o.failed,s(n);else for(i.AMap=o.loaded,e(a).then((function(){t(window.AMap)}))["catch"](s);l.length;)l.splice(0,1)[0]()},d=document.createElement("script"),d.type="text/javascript",d.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+n.AMap.version+"&key="+p+"&plugin="+n.AMap.plugins.join(","),d.onerror=function(e){i.AMap=o.failed,s(e)},c.appendChild(d)):s("请填写key")}else if(i.AMap==o.loaded)if(a.key&&a.key!==n.key)s("多个不一致的 key");else if(a.version&&a.version!==n.AMap.version)s("不允许多个版本 JSAPI 混用");else{if(p=[],a.plugins)for(c=0;c<a.plugins.length;c+=1)-1==n.AMap.plugins.indexOf(a.plugins[c])&&p.push(a.plugins[c]);p.length?window.AMap.plugin(p,(function(){e(a).then((function(){t(window.AMap)}))["catch"](s)})):e(a).then((function(){t(window.AMap)}))["catch"](s)}else if(a.key&&a.key!==n.key)s("多个不一致的 key");else if(a.version&&a.version!==n.AMap.version)s("不允许多个版本 JSAPI 混用");else{var u=[];if(a.plugins)for(c=0;c<a.plugins.length;c+=1)-1==n.AMap.plugins.indexOf(a.plugins[c])&&u.push(a.plugins[c]);r((function(){u.length?window.AMap.plugin(u,(function(){e(a).then((function(){t(window.AMap)}))["catch"](s)})):e(a).then((function(){t(window.AMap)}))["catch"](s)}))}}))},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,n={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},i={AMap:o.notload,AMapUI:o.notload,Loca:o.notload},s={AMap:[],AMapUI:[],Loca:[]}}}}))}}]);
//# sourceMappingURL=418.fb8e4fb0.js.map